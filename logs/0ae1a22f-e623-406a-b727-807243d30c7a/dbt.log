[0m11:20:50.264570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf7e813d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf7e7e8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf8199610>]}


============================== 11:20:50.272653 | a78924bb-a269-4913-a5ff-3d212d405a82 ==============================
[0m11:20:50.272653 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:20:50.280124 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/conf/sourceDir/8660e779-8a1e-4b76-9c7b-d358dde2fa77/dbt_conf', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/app/conf/sourceDir/8660e779-8a1e-4b76-9c7b-d358dde2fa77/perfdatae1@fosfor.com/data/FDC_8660e779-8a1e-4b76-9c7b-d358dde2fa77/logs/0ae1a22f-e623-406a-b727-807243d30c7a', 'debug': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build -d --log-path logs/0ae1a22f-e623-406a-b727-807243d30c7a --profiles-dir /app/conf/sourceDir/8660e779-8a1e-4b76-9c7b-d358dde2fa77/dbt_conf', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:20:51.058572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a78924bb-a269-4913-a5ff-3d212d405a82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbcc893950>]}
[0m11:20:51.129039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a78924bb-a269-4913-a5ff-3d212d405a82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf8405b50>]}
[0m11:20:51.137259 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:20:51.158102 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:20:56.018373 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m11:20:56.026872 [debug] [MainThread]: Partial parsing: added file: FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77://tests/test_Model1000_1.sql
[0m11:20:56.034343 [debug] [MainThread]: Partial parsing: added file: FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77://tests/test_Model1000_2.sql
[0m11:20:56.632181 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.8660e779-8a1e-4b76-9c7b-d358dde2fa77.table
[0m11:20:56.673345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a78924bb-a269-4913-a5ff-3d212d405a82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc8dbb1d0>]}
[0m11:20:57.984981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a78924bb-a269-4913-a5ff-3d212d405a82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc982be90>]}
[0m11:20:57.992507 [info ] [MainThread]: Found 976 models, 150 seeds, 50 snapshots, 2 data tests, 7 sources, 704 macros
[0m11:20:58.084429 [info ] [MainThread]: 
[0m11:20:58.091683 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:20:58.169834 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FDC_QA_KIRUTHIKAA'
[0m11:20:58.172011 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FDC_QA_KIRUTHIKAA'
[0m11:20:58.173986 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FDC_QA_KIRUTHIKAA'
[0m11:20:58.191156 [debug] [ThreadPool]: Using snowflake connection "list_FDC_QA_KIRUTHIKAA"
[0m11:20:58.195355 [debug] [ThreadPool]: Using snowflake connection "list_FDC_QA_KIRUTHIKAA"
[0m11:20:58.205033 [debug] [ThreadPool]: Using snowflake connection "list_FDC_QA_KIRUTHIKAA"
[0m11:20:58.211283 [debug] [ThreadPool]: On list_FDC_QA_KIRUTHIKAA: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "8660e779-8a1e-4b76-9c7b-d358dde2fa77", "target_name": "dev", "connection_name": "list_FDC_QA_KIRUTHIKAA"} */
show terse schemas in database "FDC_QA_KIRUTHIKAA"
    limit 10000
[0m11:20:58.217852 [debug] [ThreadPool]: On list_FDC_QA_KIRUTHIKAA: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "8660e779-8a1e-4b76-9c7b-d358dde2fa77", "target_name": "dev", "connection_name": "list_FDC_QA_KIRUTHIKAA"} */
show terse schemas in database "FDC_QA_KIRUTHIKAA"
    limit 10000
[0m11:20:58.223485 [debug] [ThreadPool]: On list_FDC_QA_KIRUTHIKAA: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "8660e779-8a1e-4b76-9c7b-d358dde2fa77", "target_name": "dev", "connection_name": "list_FDC_QA_KIRUTHIKAA"} */
show terse schemas in database "FDC_QA_KIRUTHIKAA"
    limit 10000
[0m11:20:58.230335 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:20:58.236552 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:20:58.242887 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:20:58.249753 [debug] [ThreadPool]: Snowflake adapter: Environment applicationName is 'None'
[0m11:20:58.256104 [debug] [ThreadPool]: Snowflake adapter: Environment applicationName is 'None'
[0m11:20:58.262408 [debug] [ThreadPool]: Snowflake adapter: Environment applicationName is 'None'
[0m11:20:59.773154 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.537 seconds
[0m11:20:59.776009 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.533 seconds
[0m11:20:59.782517 [debug] [ThreadPool]: On list_FDC_QA_KIRUTHIKAA: Close
[0m11:20:59.790194 [debug] [ThreadPool]: On list_FDC_QA_KIRUTHIKAA: Close
[0m11:20:59.946458 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.716 seconds
[0m11:20:59.955507 [debug] [ThreadPool]: On list_FDC_QA_KIRUTHIKAA: Close
[0m11:21:00.283730 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FDC_QA_KIRUTHIKAA, now list_FDC_QA_KIRUTHIKAA_TARGET)
[0m11:21:00.285808 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FDC_QA_KIRUTHIKAA, now list_FDC_QA_KIRUTHIKAA_TARGET_PUBLIC)
[0m11:21:00.287866 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FDC_QA_KIRUTHIKAA, now list_FDC_QA_KIRUTHIKAA_TARGET_TARGET)
[0m11:21:00.301437 [debug] [ThreadPool]: Using snowflake connection "list_FDC_QA_KIRUTHIKAA_TARGET"
[0m11:21:00.305932 [debug] [ThreadPool]: Using snowflake connection "list_FDC_QA_KIRUTHIKAA_TARGET_PUBLIC"
[0m11:21:00.314729 [debug] [ThreadPool]: Using snowflake connection "list_FDC_QA_KIRUTHIKAA_TARGET_TARGET"
[0m11:21:00.321219 [debug] [ThreadPool]: On list_FDC_QA_KIRUTHIKAA_TARGET: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "8660e779-8a1e-4b76-9c7b-d358dde2fa77", "target_name": "dev", "connection_name": "list_FDC_QA_KIRUTHIKAA_TARGET"} */
show objects in "FDC_QA_KIRUTHIKAA"."TARGET" limit 10000
[0m11:21:00.327494 [debug] [ThreadPool]: On list_FDC_QA_KIRUTHIKAA_TARGET_PUBLIC: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "8660e779-8a1e-4b76-9c7b-d358dde2fa77", "target_name": "dev", "connection_name": "list_FDC_QA_KIRUTHIKAA_TARGET_PUBLIC"} */
show objects in "FDC_QA_KIRUTHIKAA"."TARGET_PUBLIC" limit 10000
[0m11:21:00.333938 [debug] [ThreadPool]: On list_FDC_QA_KIRUTHIKAA_TARGET_TARGET: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "8660e779-8a1e-4b76-9c7b-d358dde2fa77", "target_name": "dev", "connection_name": "list_FDC_QA_KIRUTHIKAA_TARGET_TARGET"} */
show objects in "FDC_QA_KIRUTHIKAA"."TARGET_TARGET" limit 10000
[0m11:21:00.339478 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:21:00.345943 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:21:00.352266 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:21:00.358721 [debug] [ThreadPool]: Snowflake adapter: Environment applicationName is 'None'
[0m11:21:00.365081 [debug] [ThreadPool]: Snowflake adapter: Environment applicationName is 'None'
[0m11:21:00.371649 [debug] [ThreadPool]: Snowflake adapter: Environment applicationName is 'None'
[0m11:21:01.174219 [debug] [ThreadPool]: SQL status: SUCCESS 119 in 0.822 seconds
[0m11:21:01.187257 [debug] [ThreadPool]: On list_FDC_QA_KIRUTHIKAA_TARGET_TARGET: Close
[0m11:21:01.359325 [debug] [ThreadPool]: SQL status: SUCCESS 346 in 1.013 seconds
[0m11:21:01.382345 [debug] [ThreadPool]: On list_FDC_QA_KIRUTHIKAA_TARGET_PUBLIC: Close
[0m11:21:01.452164 [debug] [ThreadPool]: SQL status: SUCCESS 174 in 1.113 seconds
[0m11:21:01.468381 [debug] [ThreadPool]: On list_FDC_QA_KIRUTHIKAA_TARGET: Close
[0m11:21:01.707392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a78924bb-a269-4913-a5ff-3d212d405a82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc934ca90>]}
[0m11:21:01.715527 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:21:01.722189 [info ] [MainThread]: 
[0m11:21:01.747022 [debug] [Thread-1 (]: Began running node model.FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77.Model1000_1
[0m11:21:01.753265 [debug] [Thread-2 (]: Began running node model.FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77.Model1000_10
[0m11:21:01.754418 [debug] [Thread-3 (]: Began running node model.FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77.Model1000_100
[0m11:21:01.756254 [debug] [Thread-4 (]: Began running node model.FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77.Model1000_101
[0m11:21:01.759097 [info ] [Thread-1 (]: 1 of 1126 START sql table model TARGET_PUBLIC.Model1000_1 ...................... [RUN]
[0m11:21:01.765056 [info ] [Thread-2 (]: 2 of 1126 START sql table model TARGET_PUBLIC.Model1000_10 ..................... [RUN]
[0m11:21:01.772309 [info ] [Thread-3 (]: 3 of 1126 START sql table model TARGET_PUBLIC.Model1000_100 .................... [RUN]
[0m11:21:01.779506 [info ] [Thread-4 (]: 4 of 1126 START sql table model TARGET_PUBLIC.Model1000_101 .................... [RUN]
[0m11:21:01.790274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FDC_QA_KIRUTHIKAA_TARGET, now model.FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77.Model1000_1)
[0m11:21:01.796131 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_FDC_QA_KIRUTHIKAA_TARGET_PUBLIC, now model.FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77.Model1000_10)
[0m11:21:01.803357 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_FDC_QA_KIRUTHIKAA_TARGET_TARGET, now model.FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77.Model1000_100)
[0m11:21:01.810233 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77.Model1000_101'
[0m11:21:01.816966 [debug] [Thread-1 (]: Began compiling node model.FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77.Model1000_1
[0m11:21:01.823441 [debug] [Thread-2 (]: Began compiling node model.FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77.Model1000_10
[0m11:21:01.833204 [debug] [Thread-3 (]: Began compiling node model.FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77.Model1000_100
[0m11:21:01.839651 [debug] [Thread-4 (]: Began compiling node model.FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77.Model1000_101
[0m11:21:01.858089 [debug] [Thread-1 (]: Writing injected SQL for node "model.FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77.Model1000_1"
[0m11:21:01.866087 [debug] [Thread-2 (]: Writing injected SQL for node "model.FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77.Model1000_10"
[0m11:21:01.876562 [debug] [Thread-3 (]: Writing injected SQL for node "model.FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77.Model1000_100"
[0m11:21:01.887317 [debug] [Thread-4 (]: Writing injected SQL for node "model.FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77.Model1000_101"
[0m11:21:01.917800 [debug] [Thread-1 (]: Began executing node model.FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77.Model1000_1
[0m11:21:01.918892 [debug] [Thread-2 (]: Began executing node model.FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77.Model1000_10
[0m11:21:01.920712 [debug] [Thread-3 (]: Began executing node model.FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77.Model1000_100
[0m11:21:01.931451 [debug] [Thread-4 (]: Began executing node model.FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77.Model1000_101
[0m11:21:01.966724 [debug] [Thread-1 (]: Writing runtime sql for node "model.FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77.Model1000_1"
[0m11:21:01.968651 [debug] [Thread-2 (]: Writing runtime sql for node "model.FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77.Model1000_10"
[0m11:21:01.979570 [debug] [Thread-3 (]: Writing runtime sql for node "model.FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77.Model1000_100"
[0m11:21:01.991476 [debug] [Thread-4 (]: Writing runtime sql for node "model.FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77.Model1000_101"
[0m11:21:02.022544 [debug] [Thread-1 (]: Using snowflake connection "model.FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77.Model1000_1"
[0m11:21:02.029323 [debug] [Thread-3 (]: Using snowflake connection "model.FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77.Model1000_100"
[0m11:21:02.034437 [debug] [Thread-2 (]: Using snowflake connection "model.FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77.Model1000_10"
[0m11:21:02.038330 [debug] [Thread-1 (]: On model.FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77.Model1000_1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "8660e779-8a1e-4b76-9c7b-d358dde2fa77", "target_name": "dev", "node_id": "model.FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77.Model1000_1"} */
create or replace  table "FDC_QA_KIRUTHIKAA"."TARGET_PUBLIC"."Model1000_1"
         as
        (

with "Dataset" as (
SELECT * FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF100"."CUSTOMER"     
),

"Dataset_2" as (
SELECT * FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."NATION"     
),

"Join_2" as (
SELECT Dataset."C_CUSTKEY" as "C_CUSTKEY",Dataset."C_NAME" as "C_NAME",Dataset."C_ADDRESS" as "C_ADDRESS",Dataset."C_NATIONKEY" as "C_NATIONKEY",Dataset."C_PHONE" as "C_PHONE",Dataset."C_ACCTBAL" as "C_ACCTBAL",Dataset."C_MKTSEGMENT" as "C_MKTSEGMENT",Dataset."C_COMMENT" as "C_COMMENT" FROM "Dataset"  as Dataset LEFT JOIN "Dataset_2"  as Dataset_2 ON Dataset."C_NATIONKEY"=Dataset_2."N_NATIONKEY"     
),

"Union_1" as (

SELECT Dataset."C_CUSTKEY" AS "C_CUSTKEY", Dataset."C_NAME" AS "C_NAME", Dataset."C_ADDRESS" AS "C_ADDRESS", Dataset."C_NATIONKEY" AS "C_NATIONKEY", Dataset."C_PHONE" AS "C_PHONE", Dataset."C_ACCTBAL" AS "C_ACCTBAL", Dataset."C_MKTSEGMENT" AS "C_MKTSEGMENT", Dataset."C_COMMENT" AS "C_COMMENT" FROM "Dataset" AS Dataset 
UNION ALL
SELECT Join_2."C_CUSTKEY" AS "C_CUSTKEY", Join_2."C_NAME" AS "C_NAME", Join_2."C_ADDRESS" AS "C_ADDRESS", Join_2."C_NATIONKEY" AS "C_NATIONKEY", Join_2."C_PHONE" AS "C_PHONE", Join_2."C_ACCTBAL" AS "C_ACCTBAL", Join_2."C_MKTSEGMENT" AS "C_MKTSEGMENT", Join_2."C_COMMENT" AS "C_COMMENT" FROM "Join_2" AS Join_2 
      
),

"Dataset_2_2" as (
SELECT * FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"     
),

"Join_2_2" as (
SELECT Dataset_2_2."O_ORDERKEY" as "O_ORDERKEY",Dataset_2_2."O_CUSTKEY" as "O_CUSTKEY",Dataset_2_2."O_ORDERSTATUS" as "O_ORDERSTATUS",Dataset_2_2."O_TOTALPRICE" as "O_TOTALPRICE",Dataset_2_2."O_ORDERDATE" as "O_ORDERDATE",Dataset_2_2."O_ORDERPRIORITY" as "O_ORDERPRIORITY",Dataset_2_2."O_CLERK" as "O_CLERK",Dataset_2_2."O_SHIPPRIORITY" as "O_SHIPPRIORITY",Dataset_2_2."O_COMMENT" as "O_COMMENT",Join_2."C_CUSTKEY" as "C_CUSTKEY",Join_2."C_NAME" as "C_NAME",Join_2."C_ADDRESS" as "C_ADDRESS",Join_2."C_NATIONKEY" as "C_NATIONKEY",Join_2."C_PHONE" as "C_PHONE",Join_2."C_ACCTBAL" as "C_ACCTBAL",Join_2."C_MKTSEGMENT" as "C_MKTSEGMENT",Join_2."C_COMMENT" as "C_COMMENT" FROM "Dataset_2_2"  as Dataset_2_2 INNER JOIN "Join_2"  as Join_2 ON Dataset_2_2."O_CUSTKEY"=Join_2."C_CUSTKEY"     
),

"Difference" as (
SELECT Union_1."C_CUSTKEY" AS "C_CUSTKEY", Union_1."C_NAME" AS "C_NAME", Union_1."C_ADDRESS" AS "C_ADDRESS", Union_1."C_NATIONKEY" AS "C_NATIONKEY", Union_1."C_PHONE" AS "C_PHONE", Union_1."C_ACCTBAL" AS "C_ACCTBAL", Union_1."C_MKTSEGMENT" AS "C_MKTSEGMENT", Union_1."C_COMMENT" AS "C_COMMENT" FROM "Union_1" AS Union_1 

EXCEPT
SELECT Join_2_2."C_CUSTKEY" AS "C_CUSTKEY", Join_2_2."C_NAME" AS "C_NAME", Join_2_2."C_ADDRESS" AS "C_ADDRESS", Join_2_2."C_NATIONKEY" AS "C_NATIONKEY", Join_2_2."C_PHONE" AS "C_PHONE", Join_2_2."C_ACCTBAL" AS "C_ACCTBAL", Join_2_2."C_MKTSEGMENT" AS "C_MKTSEGMENT", Join_2_2."C_COMMENT" AS "C_COMMENT" FROM "Join_2_2" AS Join_2_2 

      
),

"Aggregate" as (
SELECT "C_CUSTKEY", "C_NATIONKEY", "C_ACCTBAL", count(DISTINCT "C_CUSTKEY") "NUNIQUE_C_CUSTKEY", count("C_NATIONKEY") "COUNT_C_NATIONKEY", sum("C_ACCTBAL") "SUM_C_ACCTBAL" FROM "Difference"  GROUP BY "C_CUSTKEY", "C_NATIONKEY", "C_ACCTBAL"   
),

"Transformer" as (
SELECT "NUNIQUE_C_CUSTKEY" AS "NUNIQUE_C_CUSTKEY","COUNT_C_NATIONKEY" AS "COUNT_C_NATIONKEY","SUM_C_ACCTBAL"+100 AS "SUM_C_ACCTBAL","C_CUSTKEY" AS "C_CUSTKEY","C_NATIONKEY" AS "C_NATIONKEY",TO_CHAR("C_ACCTBAL", 'XXXXXX') AS "C_ACCTBAL" FROM "Aggregate"     
),

"Dataset_2_2_2" as (
SELECT * FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."LINEITEM"     
),

"Join_2_2_2" as (
SELECT Dataset_2_2."O_ORDERKEY" as "O_ORDERKEY",Dataset_2_2_2."L_ORDERKEY" as "L_ORDERKEY",Dataset_2_2_2."L_PARTKEY" as "L_PARTKEY",Dataset_2_2_2."L_SUPPKEY" as "L_SUPPKEY",Dataset_2_2_2."L_LINENUMBER" as "L_LINENUMBER",Dataset_2_2_2."L_QUANTITY" as "L_QUANTITY",Dataset_2_2_2."L_EXTENDEDPRICE" as "L_EXTENDEDPRICE",Dataset_2_2_2."L_DISCOUNT" as "L_DISCOUNT",Dataset_2_2_2."L_TAX" as "L_TAX",Dataset_2_2_2."L_RETURNFLAG" as "L_RETURNFLAG",Dataset_2_2_2."L_LINESTATUS" as "L_LINESTATUS",Dataset_2_2_2."L_SHIPDATE" as "L_SHIPDATE",Dataset_2_2_2."L_COMMITDATE" as "L_COMMITDATE",Dataset_2_2_2."L_RECEIPTDATE" as "L_RECEIPTDATE",Dataset_2_2_2."L_SHIPINSTRUCT" as "L_SHIPINSTRUCT",Dataset_2_2_2."L_SHIPMODE" as "L_SHIPMODE",Dataset_2_2_2."L_COMMENT" as "L_COMMENT" FROM "Dataset_2_2"  as Dataset_2_2 INNER JOIN "Dataset_2_2_2"  as Dataset_2_2_2 ON Dataset_2_2."O_ORDERKEY"=Dataset_2_2_2."L_ORDERKEY"     
),

"Filter" as (
SELECT Join_2_2."O_ORDERKEY" as "O_ORDERKEY",Join_2_2."O_CUSTKEY" as "O_CUSTKEY",Join_2_2."O_ORDERSTATUS" as "O_ORDERSTATUS",Join_2_2."O_TOTALPRICE" as "O_TOTALPRICE",Join_2_2."O_ORDERDATE" as "O_ORDERDATE",Join_2_2."O_ORDERPRIORITY" as "O_ORDERPRIORITY",Join_2_2."O_CLERK" as "O_CLERK",Join_2_2."O_SHIPPRIORITY" as "O_SHIPPRIORITY",Join_2_2."O_COMMENT" as "O_COMMENT",Join_2_2."C_CUSTKEY" as "C_CUSTKEY",Join_2_2."C_NAME" as "C_NAME",Join_2_2."C_ADDRESS" as "C_ADDRESS",Join_2_2."C_NATIONKEY" as "C_NATIONKEY",Join_2_2."C_PHONE" as "C_PHONE",Join_2_2."C_ACCTBAL" as "C_ACCTBAL",Join_2_2."C_MKTSEGMENT" as "C_MKTSEGMENT",Join_2_2."C_COMMENT" as "C_COMMENT",Join_2_2_2."L_ORDERKEY" as "L_ORDERKEY",Join_2_2_2."L_PARTKEY" as "L_PARTKEY",Join_2_2_2."L_SUPPKEY" as "L_SUPPKEY",Join_2_2_2."L_LINENUMBER" as "L_LINENUMBER",Join_2_2_2."L_QUANTITY" as "L_QUANTITY",Join_2_2_2."L_EXTENDEDPRICE" as "L_EXTENDEDPRICE",Join_2_2_2."L_DISCOUNT" as "L_DISCOUNT",Join_2_2_2."L_TAX" as "L_TAX",Join_2_2_2."L_RETURNFLAG" as "L_RETURNFLAG",Join_2_2_2."L_LINESTATUS" as "L_LINESTATUS",Join_2_2_2."L_SHIPDATE" as "L_SHIPDATE",Join_2_2_2."L_COMMITDATE" as "L_COMMITDATE",Join_2_2_2."L_RECEIPTDATE" as "L_RECEIPTDATE",Join_2_2_2."L_SHIPINSTRUCT" as "L_SHIPINSTRUCT",Join_2_2_2."L_SHIPMODE" as "L_SHIPMODE",Join_2_2_2."L_COMMENT" as "L_COMMENT" FROM "Join_2_2"  as Join_2_2 FULL OUTER JOIN "Join_2_2_2"  as Join_2_2_2 ON Join_2_2."O_ORDERKEY"=Join_2_2_2."O_ORDERKEY" WHERE (
(Join_2_2."C_NATIONKEY" != 5) )    
),

"Custom_SQL" as (
select * from "Filter"      
),

"Join_4" as (
SELECT Transformer."C_NATIONKEY" as "C_NATIONKEY",Transformer."SUM_C_ACCTBAL" as "SUM_C_ACCTBAL",Transformer."COUNT_C_NATIONKEY" as "COUNT_C_NATIONKEY",Transformer."C_ACCTBAL" as "C_ACCTBAL",Transformer."C_CUSTKEY" as "C_CUSTKEY",Transformer."NUNIQUE_C_CUSTKEY" as "NUNIQUE_C_CUSTKEY",Custom_SQL."O_ORDERKEY" as "O_ORDERKEY",Custom_SQL."O_CUSTKEY" as "O_CUSTKEY",Custom_SQL."O_ORDERSTATUS" as "O_ORDERSTATUS",Custom_SQL."O_TOTALPRICE" as "O_TOTALPRICE",Custom_SQL."O_ORDERDATE" as "O_ORDERDATE",Custom_SQL."O_ORDERPRIORITY" as "O_ORDERPRIORITY",Custom_SQL."O_CLERK" as "O_CLERK",Custom_SQL."O_SHIPPRIORITY" as "O_SHIPPRIORITY",Custom_SQL."O_COMMENT" as "O_COMMENT",Custom_SQL."C_CUSTKEY" as "Custom SQL_C_CUSTKEY",Custom_SQL."C_NAME" as "C_NAME",Custom_SQL."C_ADDRESS" as "C_ADDRESS",Custom_SQL."C_NATIONKEY" as "Custom SQL_C_NATIONKEY",Custom_SQL."C_PHONE" as "C_PHONE",Custom_SQL."C_ACCTBAL" as "Custom SQL_C_ACCTBAL",Custom_SQL."C_MKTSEGMENT" as "C_MKTSEGMENT",Custom_SQL."C_COMMENT" as "C_COMMENT",Custom_SQL."L_ORDERKEY" as "L_ORDERKEY",Custom_SQL."L_PARTKEY" as "L_PARTKEY",Custom_SQL."L_SUPPKEY" as "L_SUPPKEY",Custom_SQL."L_LINENUMBER" as "L_LINENUMBER",Custom_SQL."L_QUANTITY" as "L_QUANTITY",Custom_SQL."L_EXTENDEDPRICE" as "L_EXTENDEDPRICE",Custom_SQL."L_DISCOUNT" as "L_DISCOUNT",Custom_SQL."L_TAX" as "L_TAX",Custom_SQL."L_RETURNFLAG" as "L_RETURNFLAG",Custom_SQL."L_LINESTATUS" as "L_LINESTATUS",Custom_SQL."L_SHIPDATE" as "L_SHIPDATE",Custom_SQL."L_COMMITDATE" as "L_COMMITDATE",Custom_SQL."L_RECEIPTDATE" as "L_RECEIPTDATE",Custom_SQL."L_SHIPINSTRUCT" as "L_SHIPINSTRUCT",Custom_SQL."L_SHIPMODE" as "L_SHIPMODE",Custom_SQL."L_COMMENT" as "L_COMMENT" FROM "Transformer"  as Transformer INNER JOIN "Custom_SQL"  as Custom_SQL ON Transformer."C_CUSTKEY"=Custom_SQL."O_CUSTKEY"     
)


SELECT * FROM "Join_4"
        );
[0m11:21:02.046140 [debug] [Thread-4 (]: Using snowflake connection "model.FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77.Model1000_101"
[0m11:21:02.049266 [debug] [Thread-3 (]: On model.FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77.Model1000_100: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "8660e779-8a1e-4b76-9c7b-d358dde2fa77", "target_name": "dev", "node_id": "model.FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77.Model1000_100"} */
create or replace  table "FDC_QA_KIRUTHIKAA"."TARGET_PUBLIC"."Model1000_100"
         as
        (

with "Dataset" as (
SELECT * FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF100"."CUSTOMER"     
),

"Dataset_2" as (
SELECT * FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."NATION"     
),

"Join_2" as (
SELECT Dataset."C_CUSTKEY" as "C_CUSTKEY",Dataset."C_NAME" as "C_NAME",Dataset."C_ADDRESS" as "C_ADDRESS",Dataset."C_NATIONKEY" as "C_NATIONKEY",Dataset."C_PHONE" as "C_PHONE",Dataset."C_ACCTBAL" as "C_ACCTBAL",Dataset."C_MKTSEGMENT" as "C_MKTSEGMENT",Dataset."C_COMMENT" as "C_COMMENT" FROM "Dataset"  as Dataset LEFT JOIN "Dataset_2"  as Dataset_2 ON Dataset."C_NATIONKEY"=Dataset_2."N_NATIONKEY"     
),

"Union_1" as (

SELECT Dataset."C_CUSTKEY" AS "C_CUSTKEY", Dataset."C_NAME" AS "C_NAME", Dataset."C_ADDRESS" AS "C_ADDRESS", Dataset."C_NATIONKEY" AS "C_NATIONKEY", Dataset."C_PHONE" AS "C_PHONE", Dataset."C_ACCTBAL" AS "C_ACCTBAL", Dataset."C_MKTSEGMENT" AS "C_MKTSEGMENT", Dataset."C_COMMENT" AS "C_COMMENT" FROM "Dataset" AS Dataset 
UNION ALL
SELECT Join_2."C_CUSTKEY" AS "C_CUSTKEY", Join_2."C_NAME" AS "C_NAME", Join_2."C_ADDRESS" AS "C_ADDRESS", Join_2."C_NATIONKEY" AS "C_NATIONKEY", Join_2."C_PHONE" AS "C_PHONE", Join_2."C_ACCTBAL" AS "C_ACCTBAL", Join_2."C_MKTSEGMENT" AS "C_MKTSEGMENT", Join_2."C_COMMENT" AS "C_COMMENT" FROM "Join_2" AS Join_2 
      
),

"Dataset_2_2" as (
SELECT * FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"     
),

"Join_2_2" as (
SELECT Dataset_2_2."O_ORDERKEY" as "O_ORDERKEY",Dataset_2_2."O_CUSTKEY" as "O_CUSTKEY",Dataset_2_2."O_ORDERSTATUS" as "O_ORDERSTATUS",Dataset_2_2."O_TOTALPRICE" as "O_TOTALPRICE",Dataset_2_2."O_ORDERDATE" as "O_ORDERDATE",Dataset_2_2."O_ORDERPRIORITY" as "O_ORDERPRIORITY",Dataset_2_2."O_CLERK" as "O_CLERK",Dataset_2_2."O_SHIPPRIORITY" as "O_SHIPPRIORITY",Dataset_2_2."O_COMMENT" as "O_COMMENT",Join_2."C_CUSTKEY" as "C_CUSTKEY",Join_2."C_NAME" as "C_NAME",Join_2."C_ADDRESS" as "C_ADDRESS",Join_2."C_NATIONKEY" as "C_NATIONKEY",Join_2."C_PHONE" as "C_PHONE",Join_2."C_ACCTBAL" as "C_ACCTBAL",Join_2."C_MKTSEGMENT" as "C_MKTSEGMENT",Join_2."C_COMMENT" as "C_COMMENT" FROM "Dataset_2_2"  as Dataset_2_2 INNER JOIN "Join_2"  as Join_2 ON Dataset_2_2."O_CUSTKEY"=Join_2."C_CUSTKEY"     
),

"Difference" as (
SELECT Union_1."C_CUSTKEY" AS "C_CUSTKEY", Union_1."C_NAME" AS "C_NAME", Union_1."C_ADDRESS" AS "C_ADDRESS", Union_1."C_NATIONKEY" AS "C_NATIONKEY", Union_1."C_PHONE" AS "C_PHONE", Union_1."C_ACCTBAL" AS "C_ACCTBAL", Union_1."C_MKTSEGMENT" AS "C_MKTSEGMENT", Union_1."C_COMMENT" AS "C_COMMENT" FROM "Union_1" AS Union_1 

EXCEPT
SELECT Join_2_2."C_CUSTKEY" AS "C_CUSTKEY", Join_2_2."C_NAME" AS "C_NAME", Join_2_2."C_ADDRESS" AS "C_ADDRESS", Join_2_2."C_NATIONKEY" AS "C_NATIONKEY", Join_2_2."C_PHONE" AS "C_PHONE", Join_2_2."C_ACCTBAL" AS "C_ACCTBAL", Join_2_2."C_MKTSEGMENT" AS "C_MKTSEGMENT", Join_2_2."C_COMMENT" AS "C_COMMENT" FROM "Join_2_2" AS Join_2_2 

      
),

"Aggregate" as (
SELECT "C_CUSTKEY", "C_NATIONKEY", "C_ACCTBAL", count(DISTINCT "C_CUSTKEY") "NUNIQUE_C_CUSTKEY", count("C_NATIONKEY") "COUNT_C_NATIONKEY", sum("C_ACCTBAL") "SUM_C_ACCTBAL" FROM "Difference"  GROUP BY "C_CUSTKEY", "C_NATIONKEY", "C_ACCTBAL"   
),

"Transformer" as (
SELECT "NUNIQUE_C_CUSTKEY" AS "NUNIQUE_C_CUSTKEY","COUNT_C_NATIONKEY" AS "COUNT_C_NATIONKEY","SUM_C_ACCTBAL"+100 AS "SUM_C_ACCTBAL","C_CUSTKEY" AS "C_CUSTKEY","C_NATIONKEY" AS "C_NATIONKEY",TO_CHAR("C_ACCTBAL", 'XXXXXX') AS "C_ACCTBAL" FROM "Aggregate"     
),

"Dataset_2_2_2" as (
SELECT * FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."LINEITEM"     
),

"Join_2_2_2" as (
SELECT Dataset_2_2."O_ORDERKEY" as "O_ORDERKEY",Dataset_2_2_2."L_ORDERKEY" as "L_ORDERKEY",Dataset_2_2_2."L_PARTKEY" as "L_PARTKEY",Dataset_2_2_2."L_SUPPKEY" as "L_SUPPKEY",Dataset_2_2_2."L_LINENUMBER" as "L_LINENUMBER",Dataset_2_2_2."L_QUANTITY" as "L_QUANTITY",Dataset_2_2_2."L_EXTENDEDPRICE" as "L_EXTENDEDPRICE",Dataset_2_2_2."L_DISCOUNT" as "L_DISCOUNT",Dataset_2_2_2."L_TAX" as "L_TAX",Dataset_2_2_2."L_RETURNFLAG" as "L_RETURNFLAG",Dataset_2_2_2."L_LINESTATUS" as "L_LINESTATUS",Dataset_2_2_2."L_SHIPDATE" as "L_SHIPDATE",Dataset_2_2_2."L_COMMITDATE" as "L_COMMITDATE",Dataset_2_2_2."L_RECEIPTDATE" as "L_RECEIPTDATE",Dataset_2_2_2."L_SHIPINSTRUCT" as "L_SHIPINSTRUCT",Dataset_2_2_2."L_SHIPMODE" as "L_SHIPMODE",Dataset_2_2_2."L_COMMENT" as "L_COMMENT" FROM "Dataset_2_2"  as Dataset_2_2 INNER JOIN "Dataset_2_2_2"  as Dataset_2_2_2 ON Dataset_2_2."O_ORDERKEY"=Dataset_2_2_2."L_ORDERKEY"     
),

"Filter" as (
SELECT Join_2_2."O_ORDERKEY" as "O_ORDERKEY",Join_2_2."O_CUSTKEY" as "O_CUSTKEY",Join_2_2."O_ORDERSTATUS" as "O_ORDERSTATUS",Join_2_2."O_TOTALPRICE" as "O_TOTALPRICE",Join_2_2."O_ORDERDATE" as "O_ORDERDATE",Join_2_2."O_ORDERPRIORITY" as "O_ORDERPRIORITY",Join_2_2."O_CLERK" as "O_CLERK",Join_2_2."O_SHIPPRIORITY" as "O_SHIPPRIORITY",Join_2_2."O_COMMENT" as "O_COMMENT",Join_2_2."C_CUSTKEY" as "C_CUSTKEY",Join_2_2."C_NAME" as "C_NAME",Join_2_2."C_ADDRESS" as "C_ADDRESS",Join_2_2."C_NATIONKEY" as "C_NATIONKEY",Join_2_2."C_PHONE" as "C_PHONE",Join_2_2."C_ACCTBAL" as "C_ACCTBAL",Join_2_2."C_MKTSEGMENT" as "C_MKTSEGMENT",Join_2_2."C_COMMENT" as "C_COMMENT",Join_2_2_2."L_ORDERKEY" as "L_ORDERKEY",Join_2_2_2."L_PARTKEY" as "L_PARTKEY",Join_2_2_2."L_SUPPKEY" as "L_SUPPKEY",Join_2_2_2."L_LINENUMBER" as "L_LINENUMBER",Join_2_2_2."L_QUANTITY" as "L_QUANTITY",Join_2_2_2."L_EXTENDEDPRICE" as "L_EXTENDEDPRICE",Join_2_2_2."L_DISCOUNT" as "L_DISCOUNT",Join_2_2_2."L_TAX" as "L_TAX",Join_2_2_2."L_RETURNFLAG" as "L_RETURNFLAG",Join_2_2_2."L_LINESTATUS" as "L_LINESTATUS",Join_2_2_2."L_SHIPDATE" as "L_SHIPDATE",Join_2_2_2."L_COMMITDATE" as "L_COMMITDATE",Join_2_2_2."L_RECEIPTDATE" as "L_RECEIPTDATE",Join_2_2_2."L_SHIPINSTRUCT" as "L_SHIPINSTRUCT",Join_2_2_2."L_SHIPMODE" as "L_SHIPMODE",Join_2_2_2."L_COMMENT" as "L_COMMENT" FROM "Join_2_2"  as Join_2_2 FULL OUTER JOIN "Join_2_2_2"  as Join_2_2_2 ON Join_2_2."O_ORDERKEY"=Join_2_2_2."O_ORDERKEY" WHERE (
(Join_2_2."C_NATIONKEY" != 5) )    
),

"Custom_SQL" as (
select * from "Filter"      
),

"Join_4" as (
SELECT Transformer."C_NATIONKEY" as "C_NATIONKEY",Transformer."SUM_C_ACCTBAL" as "SUM_C_ACCTBAL",Transformer."COUNT_C_NATIONKEY" as "COUNT_C_NATIONKEY",Transformer."C_ACCTBAL" as "C_ACCTBAL",Transformer."C_CUSTKEY" as "C_CUSTKEY",Transformer."NUNIQUE_C_CUSTKEY" as "NUNIQUE_C_CUSTKEY",Custom_SQL."O_ORDERKEY" as "O_ORDERKEY",Custom_SQL."O_CUSTKEY" as "O_CUSTKEY",Custom_SQL."O_ORDERSTATUS" as "O_ORDERSTATUS",Custom_SQL."O_TOTALPRICE" as "O_TOTALPRICE",Custom_SQL."O_ORDERDATE" as "O_ORDERDATE",Custom_SQL."O_ORDERPRIORITY" as "O_ORDERPRIORITY",Custom_SQL."O_CLERK" as "O_CLERK",Custom_SQL."O_SHIPPRIORITY" as "O_SHIPPRIORITY",Custom_SQL."O_COMMENT" as "O_COMMENT",Custom_SQL."C_CUSTKEY" as "Custom SQL_C_CUSTKEY",Custom_SQL."C_NAME" as "C_NAME",Custom_SQL."C_ADDRESS" as "C_ADDRESS",Custom_SQL."C_NATIONKEY" as "Custom SQL_C_NATIONKEY",Custom_SQL."C_PHONE" as "C_PHONE",Custom_SQL."C_ACCTBAL" as "Custom SQL_C_ACCTBAL",Custom_SQL."C_MKTSEGMENT" as "C_MKTSEGMENT",Custom_SQL."C_COMMENT" as "C_COMMENT",Custom_SQL."L_ORDERKEY" as "L_ORDERKEY",Custom_SQL."L_PARTKEY" as "L_PARTKEY",Custom_SQL."L_SUPPKEY" as "L_SUPPKEY",Custom_SQL."L_LINENUMBER" as "L_LINENUMBER",Custom_SQL."L_QUANTITY" as "L_QUANTITY",Custom_SQL."L_EXTENDEDPRICE" as "L_EXTENDEDPRICE",Custom_SQL."L_DISCOUNT" as "L_DISCOUNT",Custom_SQL."L_TAX" as "L_TAX",Custom_SQL."L_RETURNFLAG" as "L_RETURNFLAG",Custom_SQL."L_LINESTATUS" as "L_LINESTATUS",Custom_SQL."L_SHIPDATE" as "L_SHIPDATE",Custom_SQL."L_COMMITDATE" as "L_COMMITDATE",Custom_SQL."L_RECEIPTDATE" as "L_RECEIPTDATE",Custom_SQL."L_SHIPINSTRUCT" as "L_SHIPINSTRUCT",Custom_SQL."L_SHIPMODE" as "L_SHIPMODE",Custom_SQL."L_COMMENT" as "L_COMMENT" FROM "Transformer"  as Transformer INNER JOIN "Custom_SQL"  as Custom_SQL ON Transformer."C_CUSTKEY"=Custom_SQL."O_CUSTKEY"     
)


SELECT * FROM "Join_4"
        );
[0m11:21:02.057125 [debug] [Thread-2 (]: On model.FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77.Model1000_10: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "8660e779-8a1e-4b76-9c7b-d358dde2fa77", "target_name": "dev", "node_id": "model.FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77.Model1000_10"} */
create or replace  table "FDC_QA_KIRUTHIKAA"."TARGET_PUBLIC"."Model1000_10"
         as
        (

with "Dataset" as (
SELECT * FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF100"."CUSTOMER"     
),

"Dataset_2" as (
SELECT * FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."NATION"     
),

"Join_2" as (
SELECT Dataset."C_CUSTKEY" as "C_CUSTKEY",Dataset."C_NAME" as "C_NAME",Dataset."C_ADDRESS" as "C_ADDRESS",Dataset."C_NATIONKEY" as "C_NATIONKEY",Dataset."C_PHONE" as "C_PHONE",Dataset."C_ACCTBAL" as "C_ACCTBAL",Dataset."C_MKTSEGMENT" as "C_MKTSEGMENT",Dataset."C_COMMENT" as "C_COMMENT" FROM "Dataset"  as Dataset LEFT JOIN "Dataset_2"  as Dataset_2 ON Dataset."C_NATIONKEY"=Dataset_2."N_NATIONKEY"     
),

"Union_1" as (

SELECT Dataset."C_CUSTKEY" AS "C_CUSTKEY", Dataset."C_NAME" AS "C_NAME", Dataset."C_ADDRESS" AS "C_ADDRESS", Dataset."C_NATIONKEY" AS "C_NATIONKEY", Dataset."C_PHONE" AS "C_PHONE", Dataset."C_ACCTBAL" AS "C_ACCTBAL", Dataset."C_MKTSEGMENT" AS "C_MKTSEGMENT", Dataset."C_COMMENT" AS "C_COMMENT" FROM "Dataset" AS Dataset 
UNION ALL
SELECT Join_2."C_CUSTKEY" AS "C_CUSTKEY", Join_2."C_NAME" AS "C_NAME", Join_2."C_ADDRESS" AS "C_ADDRESS", Join_2."C_NATIONKEY" AS "C_NATIONKEY", Join_2."C_PHONE" AS "C_PHONE", Join_2."C_ACCTBAL" AS "C_ACCTBAL", Join_2."C_MKTSEGMENT" AS "C_MKTSEGMENT", Join_2."C_COMMENT" AS "C_COMMENT" FROM "Join_2" AS Join_2 
      
),

"Dataset_2_2" as (
SELECT * FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"     
),

"Join_2_2" as (
SELECT Dataset_2_2."O_ORDERKEY" as "O_ORDERKEY",Dataset_2_2."O_CUSTKEY" as "O_CUSTKEY",Dataset_2_2."O_ORDERSTATUS" as "O_ORDERSTATUS",Dataset_2_2."O_TOTALPRICE" as "O_TOTALPRICE",Dataset_2_2."O_ORDERDATE" as "O_ORDERDATE",Dataset_2_2."O_ORDERPRIORITY" as "O_ORDERPRIORITY",Dataset_2_2."O_CLERK" as "O_CLERK",Dataset_2_2."O_SHIPPRIORITY" as "O_SHIPPRIORITY",Dataset_2_2."O_COMMENT" as "O_COMMENT",Join_2."C_CUSTKEY" as "C_CUSTKEY",Join_2."C_NAME" as "C_NAME",Join_2."C_ADDRESS" as "C_ADDRESS",Join_2."C_NATIONKEY" as "C_NATIONKEY",Join_2."C_PHONE" as "C_PHONE",Join_2."C_ACCTBAL" as "C_ACCTBAL",Join_2."C_MKTSEGMENT" as "C_MKTSEGMENT",Join_2."C_COMMENT" as "C_COMMENT" FROM "Dataset_2_2"  as Dataset_2_2 INNER JOIN "Join_2"  as Join_2 ON Dataset_2_2."O_CUSTKEY"=Join_2."C_CUSTKEY"     
),

"Difference" as (
SELECT Union_1."C_CUSTKEY" AS "C_CUSTKEY", Union_1."C_NAME" AS "C_NAME", Union_1."C_ADDRESS" AS "C_ADDRESS", Union_1."C_NATIONKEY" AS "C_NATIONKEY", Union_1."C_PHONE" AS "C_PHONE", Union_1."C_ACCTBAL" AS "C_ACCTBAL", Union_1."C_MKTSEGMENT" AS "C_MKTSEGMENT", Union_1."C_COMMENT" AS "C_COMMENT" FROM "Union_1" AS Union_1 

EXCEPT
SELECT Join_2_2."C_CUSTKEY" AS "C_CUSTKEY", Join_2_2."C_NAME" AS "C_NAME", Join_2_2."C_ADDRESS" AS "C_ADDRESS", Join_2_2."C_NATIONKEY" AS "C_NATIONKEY", Join_2_2."C_PHONE" AS "C_PHONE", Join_2_2."C_ACCTBAL" AS "C_ACCTBAL", Join_2_2."C_MKTSEGMENT" AS "C_MKTSEGMENT", Join_2_2."C_COMMENT" AS "C_COMMENT" FROM "Join_2_2" AS Join_2_2 

      
),

"Aggregate" as (
SELECT "C_CUSTKEY", "C_NATIONKEY", "C_ACCTBAL", count(DISTINCT "C_CUSTKEY") "NUNIQUE_C_CUSTKEY", count("C_NATIONKEY") "COUNT_C_NATIONKEY", sum("C_ACCTBAL") "SUM_C_ACCTBAL" FROM "Difference"  GROUP BY "C_CUSTKEY", "C_NATIONKEY", "C_ACCTBAL"   
),

"Transformer" as (
SELECT "NUNIQUE_C_CUSTKEY" AS "NUNIQUE_C_CUSTKEY","COUNT_C_NATIONKEY" AS "COUNT_C_NATIONKEY","SUM_C_ACCTBAL"+100 AS "SUM_C_ACCTBAL","C_CUSTKEY" AS "C_CUSTKEY","C_NATIONKEY" AS "C_NATIONKEY",TO_CHAR("C_ACCTBAL", 'XXXXXX') AS "C_ACCTBAL" FROM "Aggregate"     
),

"Dataset_2_2_2" as (
SELECT * FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."LINEITEM"     
),

"Join_2_2_2" as (
SELECT Dataset_2_2."O_ORDERKEY" as "O_ORDERKEY",Dataset_2_2_2."L_ORDERKEY" as "L_ORDERKEY",Dataset_2_2_2."L_PARTKEY" as "L_PARTKEY",Dataset_2_2_2."L_SUPPKEY" as "L_SUPPKEY",Dataset_2_2_2."L_LINENUMBER" as "L_LINENUMBER",Dataset_2_2_2."L_QUANTITY" as "L_QUANTITY",Dataset_2_2_2."L_EXTENDEDPRICE" as "L_EXTENDEDPRICE",Dataset_2_2_2."L_DISCOUNT" as "L_DISCOUNT",Dataset_2_2_2."L_TAX" as "L_TAX",Dataset_2_2_2."L_RETURNFLAG" as "L_RETURNFLAG",Dataset_2_2_2."L_LINESTATUS" as "L_LINESTATUS",Dataset_2_2_2."L_SHIPDATE" as "L_SHIPDATE",Dataset_2_2_2."L_COMMITDATE" as "L_COMMITDATE",Dataset_2_2_2."L_RECEIPTDATE" as "L_RECEIPTDATE",Dataset_2_2_2."L_SHIPINSTRUCT" as "L_SHIPINSTRUCT",Dataset_2_2_2."L_SHIPMODE" as "L_SHIPMODE",Dataset_2_2_2."L_COMMENT" as "L_COMMENT" FROM "Dataset_2_2"  as Dataset_2_2 INNER JOIN "Dataset_2_2_2"  as Dataset_2_2_2 ON Dataset_2_2."O_ORDERKEY"=Dataset_2_2_2."L_ORDERKEY"     
),

"Filter" as (
SELECT Join_2_2."O_ORDERKEY" as "O_ORDERKEY",Join_2_2."O_CUSTKEY" as "O_CUSTKEY",Join_2_2."O_ORDERSTATUS" as "O_ORDERSTATUS",Join_2_2."O_TOTALPRICE" as "O_TOTALPRICE",Join_2_2."O_ORDERDATE" as "O_ORDERDATE",Join_2_2."O_ORDERPRIORITY" as "O_ORDERPRIORITY",Join_2_2."O_CLERK" as "O_CLERK",Join_2_2."O_SHIPPRIORITY" as "O_SHIPPRIORITY",Join_2_2."O_COMMENT" as "O_COMMENT",Join_2_2."C_CUSTKEY" as "C_CUSTKEY",Join_2_2."C_NAME" as "C_NAME",Join_2_2."C_ADDRESS" as "C_ADDRESS",Join_2_2."C_NATIONKEY" as "C_NATIONKEY",Join_2_2."C_PHONE" as "C_PHONE",Join_2_2."C_ACCTBAL" as "C_ACCTBAL",Join_2_2."C_MKTSEGMENT" as "C_MKTSEGMENT",Join_2_2."C_COMMENT" as "C_COMMENT",Join_2_2_2."L_ORDERKEY" as "L_ORDERKEY",Join_2_2_2."L_PARTKEY" as "L_PARTKEY",Join_2_2_2."L_SUPPKEY" as "L_SUPPKEY",Join_2_2_2."L_LINENUMBER" as "L_LINENUMBER",Join_2_2_2."L_QUANTITY" as "L_QUANTITY",Join_2_2_2."L_EXTENDEDPRICE" as "L_EXTENDEDPRICE",Join_2_2_2."L_DISCOUNT" as "L_DISCOUNT",Join_2_2_2."L_TAX" as "L_TAX",Join_2_2_2."L_RETURNFLAG" as "L_RETURNFLAG",Join_2_2_2."L_LINESTATUS" as "L_LINESTATUS",Join_2_2_2."L_SHIPDATE" as "L_SHIPDATE",Join_2_2_2."L_COMMITDATE" as "L_COMMITDATE",Join_2_2_2."L_RECEIPTDATE" as "L_RECEIPTDATE",Join_2_2_2."L_SHIPINSTRUCT" as "L_SHIPINSTRUCT",Join_2_2_2."L_SHIPMODE" as "L_SHIPMODE",Join_2_2_2."L_COMMENT" as "L_COMMENT" FROM "Join_2_2"  as Join_2_2 FULL OUTER JOIN "Join_2_2_2"  as Join_2_2_2 ON Join_2_2."O_ORDERKEY"=Join_2_2_2."O_ORDERKEY" WHERE (
(Join_2_2."C_NATIONKEY" != 5) )    
),

"Custom_SQL" as (
select * from "Filter"      
),

"Join_4" as (
SELECT Transformer."C_NATIONKEY" as "C_NATIONKEY",Transformer."SUM_C_ACCTBAL" as "SUM_C_ACCTBAL",Transformer."COUNT_C_NATIONKEY" as "COUNT_C_NATIONKEY",Transformer."C_ACCTBAL" as "C_ACCTBAL",Transformer."C_CUSTKEY" as "C_CUSTKEY",Transformer."NUNIQUE_C_CUSTKEY" as "NUNIQUE_C_CUSTKEY",Custom_SQL."O_ORDERKEY" as "O_ORDERKEY",Custom_SQL."O_CUSTKEY" as "O_CUSTKEY",Custom_SQL."O_ORDERSTATUS" as "O_ORDERSTATUS",Custom_SQL."O_TOTALPRICE" as "O_TOTALPRICE",Custom_SQL."O_ORDERDATE" as "O_ORDERDATE",Custom_SQL."O_ORDERPRIORITY" as "O_ORDERPRIORITY",Custom_SQL."O_CLERK" as "O_CLERK",Custom_SQL."O_SHIPPRIORITY" as "O_SHIPPRIORITY",Custom_SQL."O_COMMENT" as "O_COMMENT",Custom_SQL."C_CUSTKEY" as "Custom SQL_C_CUSTKEY",Custom_SQL."C_NAME" as "C_NAME",Custom_SQL."C_ADDRESS" as "C_ADDRESS",Custom_SQL."C_NATIONKEY" as "Custom SQL_C_NATIONKEY",Custom_SQL."C_PHONE" as "C_PHONE",Custom_SQL."C_ACCTBAL" as "Custom SQL_C_ACCTBAL",Custom_SQL."C_MKTSEGMENT" as "C_MKTSEGMENT",Custom_SQL."C_COMMENT" as "C_COMMENT",Custom_SQL."L_ORDERKEY" as "L_ORDERKEY",Custom_SQL."L_PARTKEY" as "L_PARTKEY",Custom_SQL."L_SUPPKEY" as "L_SUPPKEY",Custom_SQL."L_LINENUMBER" as "L_LINENUMBER",Custom_SQL."L_QUANTITY" as "L_QUANTITY",Custom_SQL."L_EXTENDEDPRICE" as "L_EXTENDEDPRICE",Custom_SQL."L_DISCOUNT" as "L_DISCOUNT",Custom_SQL."L_TAX" as "L_TAX",Custom_SQL."L_RETURNFLAG" as "L_RETURNFLAG",Custom_SQL."L_LINESTATUS" as "L_LINESTATUS",Custom_SQL."L_SHIPDATE" as "L_SHIPDATE",Custom_SQL."L_COMMITDATE" as "L_COMMITDATE",Custom_SQL."L_RECEIPTDATE" as "L_RECEIPTDATE",Custom_SQL."L_SHIPINSTRUCT" as "L_SHIPINSTRUCT",Custom_SQL."L_SHIPMODE" as "L_SHIPMODE",Custom_SQL."L_COMMENT" as "L_COMMENT" FROM "Transformer"  as Transformer INNER JOIN "Custom_SQL"  as Custom_SQL ON Transformer."C_CUSTKEY"=Custom_SQL."O_CUSTKEY"     
)


SELECT * FROM "Join_4"
        );
[0m11:21:02.064570 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:21:02.071851 [debug] [Thread-4 (]: On model.FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77.Model1000_101: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "8660e779-8a1e-4b76-9c7b-d358dde2fa77", "target_name": "dev", "node_id": "model.FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77.Model1000_101"} */
create or replace  table "FDC_QA_KIRUTHIKAA"."TARGET_PUBLIC"."Model1000_101"
         as
        (

with "Dataset" as (
SELECT * FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF100"."CUSTOMER"     
),

"Dataset_2" as (
SELECT * FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."NATION"     
),

"Join_2" as (
SELECT Dataset."C_CUSTKEY" as "C_CUSTKEY",Dataset."C_NAME" as "C_NAME",Dataset."C_ADDRESS" as "C_ADDRESS",Dataset."C_NATIONKEY" as "C_NATIONKEY",Dataset."C_PHONE" as "C_PHONE",Dataset."C_ACCTBAL" as "C_ACCTBAL",Dataset."C_MKTSEGMENT" as "C_MKTSEGMENT",Dataset."C_COMMENT" as "C_COMMENT" FROM "Dataset"  as Dataset LEFT JOIN "Dataset_2"  as Dataset_2 ON Dataset."C_NATIONKEY"=Dataset_2."N_NATIONKEY"     
),

"Union_1" as (

SELECT Dataset."C_CUSTKEY" AS "C_CUSTKEY", Dataset."C_NAME" AS "C_NAME", Dataset."C_ADDRESS" AS "C_ADDRESS", Dataset."C_NATIONKEY" AS "C_NATIONKEY", Dataset."C_PHONE" AS "C_PHONE", Dataset."C_ACCTBAL" AS "C_ACCTBAL", Dataset."C_MKTSEGMENT" AS "C_MKTSEGMENT", Dataset."C_COMMENT" AS "C_COMMENT" FROM "Dataset" AS Dataset 
UNION ALL
SELECT Join_2."C_CUSTKEY" AS "C_CUSTKEY", Join_2."C_NAME" AS "C_NAME", Join_2."C_ADDRESS" AS "C_ADDRESS", Join_2."C_NATIONKEY" AS "C_NATIONKEY", Join_2."C_PHONE" AS "C_PHONE", Join_2."C_ACCTBAL" AS "C_ACCTBAL", Join_2."C_MKTSEGMENT" AS "C_MKTSEGMENT", Join_2."C_COMMENT" AS "C_COMMENT" FROM "Join_2" AS Join_2 
      
),

"Dataset_2_2" as (
SELECT * FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"     
),

"Join_2_2" as (
SELECT Dataset_2_2."O_ORDERKEY" as "O_ORDERKEY",Dataset_2_2."O_CUSTKEY" as "O_CUSTKEY",Dataset_2_2."O_ORDERSTATUS" as "O_ORDERSTATUS",Dataset_2_2."O_TOTALPRICE" as "O_TOTALPRICE",Dataset_2_2."O_ORDERDATE" as "O_ORDERDATE",Dataset_2_2."O_ORDERPRIORITY" as "O_ORDERPRIORITY",Dataset_2_2."O_CLERK" as "O_CLERK",Dataset_2_2."O_SHIPPRIORITY" as "O_SHIPPRIORITY",Dataset_2_2."O_COMMENT" as "O_COMMENT",Join_2."C_CUSTKEY" as "C_CUSTKEY",Join_2."C_NAME" as "C_NAME",Join_2."C_ADDRESS" as "C_ADDRESS",Join_2."C_NATIONKEY" as "C_NATIONKEY",Join_2."C_PHONE" as "C_PHONE",Join_2."C_ACCTBAL" as "C_ACCTBAL",Join_2."C_MKTSEGMENT" as "C_MKTSEGMENT",Join_2."C_COMMENT" as "C_COMMENT" FROM "Dataset_2_2"  as Dataset_2_2 INNER JOIN "Join_2"  as Join_2 ON Dataset_2_2."O_CUSTKEY"=Join_2."C_CUSTKEY"     
),

"Difference" as (
SELECT Union_1."C_CUSTKEY" AS "C_CUSTKEY", Union_1."C_NAME" AS "C_NAME", Union_1."C_ADDRESS" AS "C_ADDRESS", Union_1."C_NATIONKEY" AS "C_NATIONKEY", Union_1."C_PHONE" AS "C_PHONE", Union_1."C_ACCTBAL" AS "C_ACCTBAL", Union_1."C_MKTSEGMENT" AS "C_MKTSEGMENT", Union_1."C_COMMENT" AS "C_COMMENT" FROM "Union_1" AS Union_1 

EXCEPT
SELECT Join_2_2."C_CUSTKEY" AS "C_CUSTKEY", Join_2_2."C_NAME" AS "C_NAME", Join_2_2."C_ADDRESS" AS "C_ADDRESS", Join_2_2."C_NATIONKEY" AS "C_NATIONKEY", Join_2_2."C_PHONE" AS "C_PHONE", Join_2_2."C_ACCTBAL" AS "C_ACCTBAL", Join_2_2."C_MKTSEGMENT" AS "C_MKTSEGMENT", Join_2_2."C_COMMENT" AS "C_COMMENT" FROM "Join_2_2" AS Join_2_2 

      
),

"Aggregate" as (
SELECT "C_CUSTKEY", "C_NATIONKEY", "C_ACCTBAL", count(DISTINCT "C_CUSTKEY") "NUNIQUE_C_CUSTKEY", count("C_NATIONKEY") "COUNT_C_NATIONKEY", sum("C_ACCTBAL") "SUM_C_ACCTBAL" FROM "Difference"  GROUP BY "C_CUSTKEY", "C_NATIONKEY", "C_ACCTBAL"   
),

"Transformer" as (
SELECT "NUNIQUE_C_CUSTKEY" AS "NUNIQUE_C_CUSTKEY","COUNT_C_NATIONKEY" AS "COUNT_C_NATIONKEY","SUM_C_ACCTBAL"+100 AS "SUM_C_ACCTBAL","C_CUSTKEY" AS "C_CUSTKEY","C_NATIONKEY" AS "C_NATIONKEY",TO_CHAR("C_ACCTBAL", 'XXXXXX') AS "C_ACCTBAL" FROM "Aggregate"     
),

"Dataset_2_2_2" as (
SELECT * FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."LINEITEM"     
),

"Join_2_2_2" as (
SELECT Dataset_2_2."O_ORDERKEY" as "O_ORDERKEY",Dataset_2_2_2."L_ORDERKEY" as "L_ORDERKEY",Dataset_2_2_2."L_PARTKEY" as "L_PARTKEY",Dataset_2_2_2."L_SUPPKEY" as "L_SUPPKEY",Dataset_2_2_2."L_LINENUMBER" as "L_LINENUMBER",Dataset_2_2_2."L_QUANTITY" as "L_QUANTITY",Dataset_2_2_2."L_EXTENDEDPRICE" as "L_EXTENDEDPRICE",Dataset_2_2_2."L_DISCOUNT" as "L_DISCOUNT",Dataset_2_2_2."L_TAX" as "L_TAX",Dataset_2_2_2."L_RETURNFLAG" as "L_RETURNFLAG",Dataset_2_2_2."L_LINESTATUS" as "L_LINESTATUS",Dataset_2_2_2."L_SHIPDATE" as "L_SHIPDATE",Dataset_2_2_2."L_COMMITDATE" as "L_COMMITDATE",Dataset_2_2_2."L_RECEIPTDATE" as "L_RECEIPTDATE",Dataset_2_2_2."L_SHIPINSTRUCT" as "L_SHIPINSTRUCT",Dataset_2_2_2."L_SHIPMODE" as "L_SHIPMODE",Dataset_2_2_2."L_COMMENT" as "L_COMMENT" FROM "Dataset_2_2"  as Dataset_2_2 INNER JOIN "Dataset_2_2_2"  as Dataset_2_2_2 ON Dataset_2_2."O_ORDERKEY"=Dataset_2_2_2."L_ORDERKEY"     
),

"Filter" as (
SELECT Join_2_2."O_ORDERKEY" as "O_ORDERKEY",Join_2_2."O_CUSTKEY" as "O_CUSTKEY",Join_2_2."O_ORDERSTATUS" as "O_ORDERSTATUS",Join_2_2."O_TOTALPRICE" as "O_TOTALPRICE",Join_2_2."O_ORDERDATE" as "O_ORDERDATE",Join_2_2."O_ORDERPRIORITY" as "O_ORDERPRIORITY",Join_2_2."O_CLERK" as "O_CLERK",Join_2_2."O_SHIPPRIORITY" as "O_SHIPPRIORITY",Join_2_2."O_COMMENT" as "O_COMMENT",Join_2_2."C_CUSTKEY" as "C_CUSTKEY",Join_2_2."C_NAME" as "C_NAME",Join_2_2."C_ADDRESS" as "C_ADDRESS",Join_2_2."C_NATIONKEY" as "C_NATIONKEY",Join_2_2."C_PHONE" as "C_PHONE",Join_2_2."C_ACCTBAL" as "C_ACCTBAL",Join_2_2."C_MKTSEGMENT" as "C_MKTSEGMENT",Join_2_2."C_COMMENT" as "C_COMMENT",Join_2_2_2."L_ORDERKEY" as "L_ORDERKEY",Join_2_2_2."L_PARTKEY" as "L_PARTKEY",Join_2_2_2."L_SUPPKEY" as "L_SUPPKEY",Join_2_2_2."L_LINENUMBER" as "L_LINENUMBER",Join_2_2_2."L_QUANTITY" as "L_QUANTITY",Join_2_2_2."L_EXTENDEDPRICE" as "L_EXTENDEDPRICE",Join_2_2_2."L_DISCOUNT" as "L_DISCOUNT",Join_2_2_2."L_TAX" as "L_TAX",Join_2_2_2."L_RETURNFLAG" as "L_RETURNFLAG",Join_2_2_2."L_LINESTATUS" as "L_LINESTATUS",Join_2_2_2."L_SHIPDATE" as "L_SHIPDATE",Join_2_2_2."L_COMMITDATE" as "L_COMMITDATE",Join_2_2_2."L_RECEIPTDATE" as "L_RECEIPTDATE",Join_2_2_2."L_SHIPINSTRUCT" as "L_SHIPINSTRUCT",Join_2_2_2."L_SHIPMODE" as "L_SHIPMODE",Join_2_2_2."L_COMMENT" as "L_COMMENT" FROM "Join_2_2"  as Join_2_2 FULL OUTER JOIN "Join_2_2_2"  as Join_2_2_2 ON Join_2_2."O_ORDERKEY"=Join_2_2_2."O_ORDERKEY" WHERE (
(Join_2_2."C_NATIONKEY" != 5) )    
),

"Custom_SQL" as (
select * from "Filter"      
),

"Join_4" as (
SELECT Transformer."C_NATIONKEY" as "C_NATIONKEY",Transformer."SUM_C_ACCTBAL" as "SUM_C_ACCTBAL",Transformer."COUNT_C_NATIONKEY" as "COUNT_C_NATIONKEY",Transformer."C_ACCTBAL" as "C_ACCTBAL",Transformer."C_CUSTKEY" as "C_CUSTKEY",Transformer."NUNIQUE_C_CUSTKEY" as "NUNIQUE_C_CUSTKEY",Custom_SQL."O_ORDERKEY" as "O_ORDERKEY",Custom_SQL."O_CUSTKEY" as "O_CUSTKEY",Custom_SQL."O_ORDERSTATUS" as "O_ORDERSTATUS",Custom_SQL."O_TOTALPRICE" as "O_TOTALPRICE",Custom_SQL."O_ORDERDATE" as "O_ORDERDATE",Custom_SQL."O_ORDERPRIORITY" as "O_ORDERPRIORITY",Custom_SQL."O_CLERK" as "O_CLERK",Custom_SQL."O_SHIPPRIORITY" as "O_SHIPPRIORITY",Custom_SQL."O_COMMENT" as "O_COMMENT",Custom_SQL."C_CUSTKEY" as "Custom SQL_C_CUSTKEY",Custom_SQL."C_NAME" as "C_NAME",Custom_SQL."C_ADDRESS" as "C_ADDRESS",Custom_SQL."C_NATIONKEY" as "Custom SQL_C_NATIONKEY",Custom_SQL."C_PHONE" as "C_PHONE",Custom_SQL."C_ACCTBAL" as "Custom SQL_C_ACCTBAL",Custom_SQL."C_MKTSEGMENT" as "C_MKTSEGMENT",Custom_SQL."C_COMMENT" as "C_COMMENT",Custom_SQL."L_ORDERKEY" as "L_ORDERKEY",Custom_SQL."L_PARTKEY" as "L_PARTKEY",Custom_SQL."L_SUPPKEY" as "L_SUPPKEY",Custom_SQL."L_LINENUMBER" as "L_LINENUMBER",Custom_SQL."L_QUANTITY" as "L_QUANTITY",Custom_SQL."L_EXTENDEDPRICE" as "L_EXTENDEDPRICE",Custom_SQL."L_DISCOUNT" as "L_DISCOUNT",Custom_SQL."L_TAX" as "L_TAX",Custom_SQL."L_RETURNFLAG" as "L_RETURNFLAG",Custom_SQL."L_LINESTATUS" as "L_LINESTATUS",Custom_SQL."L_SHIPDATE" as "L_SHIPDATE",Custom_SQL."L_COMMITDATE" as "L_COMMITDATE",Custom_SQL."L_RECEIPTDATE" as "L_RECEIPTDATE",Custom_SQL."L_SHIPINSTRUCT" as "L_SHIPINSTRUCT",Custom_SQL."L_SHIPMODE" as "L_SHIPMODE",Custom_SQL."L_COMMENT" as "L_COMMENT" FROM "Transformer"  as Transformer INNER JOIN "Custom_SQL"  as Custom_SQL ON Transformer."C_CUSTKEY"=Custom_SQL."O_CUSTKEY"     
)


SELECT * FROM "Join_4"
        );
[0m11:21:02.078146 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:21:02.084950 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:21:02.091940 [debug] [Thread-1 (]: Snowflake adapter: Environment applicationName is 'None'
[0m11:21:02.098344 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:21:02.105187 [debug] [Thread-3 (]: Snowflake adapter: Environment applicationName is 'None'
[0m11:21:02.111743 [debug] [Thread-2 (]: Snowflake adapter: Environment applicationName is 'None'
[0m11:21:02.123870 [debug] [Thread-4 (]: Snowflake adapter: Environment applicationName is 'None'
[0m11:22:12.630417 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 70.545 seconds
[0m11:22:12.664289 [debug] [Thread-2 (]: On model.FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77.Model1000_10: Close
[0m11:22:12.864092 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a78924bb-a269-4913-a5ff-3d212d405a82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc7fff9d0>]}
[0m11:22:12.872358 [info ] [Thread-2 (]: 2 of 1126 OK created sql table model TARGET_PUBLIC.Model1000_10 ................ [[32mSUCCESS 1[0m in 71.07s]
[0m11:22:12.880315 [debug] [Thread-2 (]: Finished running node model.FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77.Model1000_10
[0m11:22:12.887789 [debug] [Thread-2 (]: Began running node model.FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77.Model1000_102
[0m11:22:12.895597 [info ] [Thread-2 (]: 5 of 1126 START sql table model TARGET_PUBLIC.Model1000_102 .................... [RUN]
[0m11:22:12.903224 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77.Model1000_10, now model.FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77.Model1000_102)
[0m11:22:12.910889 [debug] [Thread-2 (]: Began compiling node model.FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77.Model1000_102
[0m11:22:12.924353 [debug] [Thread-2 (]: Writing injected SQL for node "model.FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77.Model1000_102"
[0m11:22:12.951578 [debug] [Thread-2 (]: Began executing node model.FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77.Model1000_102
[0m11:22:12.964729 [debug] [Thread-2 (]: Writing runtime sql for node "model.FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77.Model1000_102"
[0m11:22:13.002665 [debug] [Thread-2 (]: Using snowflake connection "model.FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77.Model1000_102"
[0m11:22:13.017515 [debug] [Thread-2 (]: On model.FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77.Model1000_102: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "8660e779-8a1e-4b76-9c7b-d358dde2fa77", "target_name": "dev", "node_id": "model.FDC_8660e779_8a1e_4b76_9c7b_d358dde2fa77.Model1000_102"} */
create or replace  table "FDC_QA_KIRUTHIKAA"."TARGET_PUBLIC"."Model1000_102"
         as
        (

with "Dataset" as (
SELECT * FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF100"."CUSTOMER"     
),

"Dataset_2" as (
SELECT * FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."NATION"     
),

"Join_2" as (
SELECT Dataset."C_CUSTKEY" as "C_CUSTKEY",Dataset."C_NAME" as "C_NAME",Dataset."C_ADDRESS" as "C_ADDRESS",Dataset."C_NATIONKEY" as "C_NATIONKEY",Dataset."C_PHONE" as "C_PHONE",Dataset."C_ACCTBAL" as "C_ACCTBAL",Dataset."C_MKTSEGMENT" as "C_MKTSEGMENT",Dataset."C_COMMENT" as "C_COMMENT" FROM "Dataset"  as Dataset LEFT JOIN "Dataset_2"  as Dataset_2 ON Dataset."C_NATIONKEY"=Dataset_2."N_NATIONKEY"     
),

"Union_1" as (

SELECT Dataset."C_CUSTKEY" AS "C_CUSTKEY", Dataset."C_NAME" AS "C_NAME", Dataset."C_ADDRESS" AS "C_ADDRESS", Dataset."C_NATIONKEY" AS "C_NATIONKEY", Dataset."C_PHONE" AS "C_PHONE", Dataset."C_ACCTBAL" AS "C_ACCTBAL", Dataset."C_MKTSEGMENT" AS "C_MKTSEGMENT", Dataset."C_COMMENT" AS "C_COMMENT" FROM "Dataset" AS Dataset 
UNION ALL
SELECT Join_2."C_CUSTKEY" AS "C_CUSTKEY", Join_2."C_NAME" AS "C_NAME", Join_2."C_ADDRESS" AS "C_ADDRESS", Join_2."C_NATIONKEY" AS "C_NATIONKEY", Join_2."C_PHONE" AS "C_PHONE", Join_2."C_ACCTBAL" AS "C_ACCTBAL", Join_2."C_MKTSEGMENT" AS "C_MKTSEGMENT", Join_2."C_COMMENT" AS "C_COMMENT" FROM "Join_2" AS Join_2 
      
),

"Dataset_2_2" as (
SELECT * FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"     
),

"Join_2_2" as (
SELECT Dataset_2_2."O_ORDERKEY" as "O_ORDERKEY",Dataset_2_2."O_CUSTKEY" as "O_CUSTKEY",Dataset_2_2."O_ORDERSTATUS" as "O_ORDERSTATUS",Dataset_2_2."O_TOTALPRICE" as "O_TOTALPRICE",Dataset_2_2."O_ORDERDATE" as "O_ORDERDATE",Dataset_2_2."O_ORDERPRIORITY" as "O_ORDERPRIORITY",Dataset_2_2."O_CLERK" as "O_CLERK",Dataset_2_2."O_SHIPPRIORITY" as "O_SHIPPRIORITY",Dataset_2_2."O_COMMENT" as "O_COMMENT",Join_2."C_CUSTKEY" as "C_CUSTKEY",Join_2."C_NAME" as "C_NAME",Join_2."C_ADDRESS" as "C_ADDRESS",Join_2."C_NATIONKEY" as "C_NATIONKEY",Join_2."C_PHONE" as "C_PHONE",Join_2."C_ACCTBAL" as "C_ACCTBAL",Join_2."C_MKTSEGMENT" as "C_MKTSEGMENT",Join_2."C_COMMENT" as "C_COMMENT" FROM "Dataset_2_2"  as Dataset_2_2 INNER JOIN "Join_2"  as Join_2 ON Dataset_2_2."O_CUSTKEY"=Join_2."C_CUSTKEY"     
),

"Difference" as (
SELECT Union_1."C_CUSTKEY" AS "C_CUSTKEY", Union_1."C_NAME" AS "C_NAME", Union_1."C_ADDRESS" AS "C_ADDRESS", Union_1."C_NATIONKEY" AS "C_NATIONKEY", Union_1."C_PHONE" AS "C_PHONE", Union_1."C_ACCTBAL" AS "C_ACCTBAL", Union_1."C_MKTSEGMENT" AS "C_MKTSEGMENT", Union_1."C_COMMENT" AS "C_COMMENT" FROM "Union_1" AS Union_1 

EXCEPT
SELECT Join_2_2."C_CUSTKEY" AS "C_CUSTKEY", Join_2_2."C_NAME" AS "C_NAME", Join_2_2."C_ADDRESS" AS "C_ADDRESS", Join_2_2."C_NATIONKEY" AS "C_NATIONKEY", Join_2_2."C_PHONE" AS "C_PHONE", Join_2_2."C_ACCTBAL" AS "C_ACCTBAL", Join_2_2."C_MKTSEGMENT" AS "C_MKTSEGMENT", Join_2_2."C_COMMENT" AS "C_COMMENT" FROM "Join_2_2" AS Join_2_2 

      
),

"Aggregate" as (
SELECT "C_CUSTKEY", "C_NATIONKEY", "C_ACCTBAL", count(DISTINCT "C_CUSTKEY") "NUNIQUE_C_CUSTKEY", count("C_NATIONKEY") "COUNT_C_NATIONKEY", sum("C_ACCTBAL") "SUM_C_ACCTBAL" FROM "Difference"  GROUP BY "C_CUSTKEY", "C_NATIONKEY", "C_ACCTBAL"   
),

"Transformer" as (
SELECT "NUNIQUE_C_CUSTKEY" AS "NUNIQUE_C_CUSTKEY","COUNT_C_NATIONKEY" AS "COUNT_C_NATIONKEY","SUM_C_ACCTBAL"+100 AS "SUM_C_ACCTBAL","C_CUSTKEY" AS "C_CUSTKEY","C_NATIONKEY" AS "C_NATIONKEY",TO_CHAR("C_ACCTBAL", 'XXXXXX') AS "C_ACCTBAL" FROM "Aggregate"     
),

"Dataset_2_2_2" as (
SELECT * FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."LINEITEM"     
),

"Join_2_2_2" as (
SELECT Dataset_2_2."O_ORDERKEY" as "O_ORDERKEY",Dataset_2_2_2."L_ORDERKEY" as "L_ORDERKEY",Dataset_2_2_2."L_PARTKEY" as "L_PARTKEY",Dataset_2_2_2."L_SUPPKEY" as "L_SUPPKEY",Dataset_2_2_2."L_LINENUMBER" as "L_LINENUMBER",Dataset_2_2_2."L_QUANTITY" as "L_QUANTITY",Dataset_2_2_2."L_EXTENDEDPRICE" as "L_EXTENDEDPRICE",Dataset_2_2_2."L_DISCOUNT" as "L_DISCOUNT",Dataset_2_2_2."L_TAX" as "L_TAX",Dataset_2_2_2."L_RETURNFLAG" as "L_RETURNFLAG",Dataset_2_2_2."L_LINESTATUS" as "L_LINESTATUS",Dataset_2_2_2."L_SHIPDATE" as "L_SHIPDATE",Dataset_2_2_2."L_COMMITDATE" as "L_COMMITDATE",Dataset_2_2_2."L_RECEIPTDATE" as "L_RECEIPTDATE",Dataset_2_2_2."L_SHIPINSTRUCT" as "L_SHIPINSTRUCT",Dataset_2_2_2."L_SHIPMODE" as "L_SHIPMODE",Dataset_2_2_2."L_COMMENT" as "L_COMMENT" FROM "Dataset_2_2"  as Dataset_2_2 INNER JOIN "Dataset_2_2_2"  as Dataset_2_2_2 ON Dataset_2_2."O_ORDERKEY"=Dataset_2_2_2."L_ORDERKEY"     
),

"Filter" as (
SELECT Join_2_2."O_ORDERKEY" as "O_ORDERKEY",Join_2_2."O_CUSTKEY" as "O_CUSTKEY",Join_2_2."O_ORDERSTATUS" as "O_ORDERSTATUS",Join_2_2."O_TOTALPRICE" as "O_TOTALPRICE",Join_2_2."O_ORDERDATE" as "O_ORDERDATE",Join_2_2."O_ORDERPRIORITY" as "O_ORDERPRIORITY",Join_2_2."O_CLERK" as "O_CLERK",Join_2_2."O_SHIPPRIORITY" as "O_SHIPPRIORITY",Join_2_2."O_COMMENT" as "O_COMMENT",Join_2_2."C_CUSTKEY" as "C_CUSTKEY",Join_2_2."C_NAME" as "C_NAME",Join_2_2."C_ADDRESS" as "C_ADDRESS",Join_2_2."C_NATIONKEY" as "C_NATIONKEY",Join_2_2."C_PHONE" as "C_PHONE",Join_2_2."C_ACCTBAL" as "C_ACCTBAL",Join_2_2."C_MKTSEGMENT" as "C_MKTSEGMENT",Join_2_2."C_COMMENT" as "C_COMMENT",Join_2_2_2."L_ORDERKEY" as "L_ORDERKEY",Join_2_2_2."L_PARTKEY" as "L_PARTKEY",Join_2_2_2."L_SUPPKEY" as "L_SUPPKEY",Join_2_2_2."L_LINENUMBER" as "L_LINENUMBER",Join_2_2_2."L_QUANTITY" as "L_QUANTITY",Join_2_2_2."L_EXTENDEDPRICE" as "L_EXTENDEDPRICE",Join_2_2_2."L_DISCOUNT" as "L_DISCOUNT",Join_2_2_2."L_TAX" as "L_TAX",Join_2_2_2."L_RETURNFLAG" as "L_RETURNFLAG",Join_2_2_2."L_LINESTATUS" as "L_LINESTATUS",Join_2_2_2."L_SHIPDATE" as "L_SHIPDATE",Join_2_2_2."L_COMMITDATE" as "L_COMMITDATE",Join_2_2_2."L_RECEIPTDATE" as "L_RECEIPTDATE",Join_2_2_2."L_SHIPINSTRUCT" as "L_SHIPINSTRUCT",Join_2_2_2."L_SHIPMODE" as "L_SHIPMODE",Join_2_2_2."L_COMMENT" as "L_COMMENT" FROM "Join_2_2"  as Join_2_2 FULL OUTER JOIN "Join_2_2_2"  as Join_2_2_2 ON Join_2_2."O_ORDERKEY"=Join_2_2_2."O_ORDERKEY" WHERE (
(Join_2_2."C_NATIONKEY" != 5) )    
),

"Custom_SQL" as (
select * from "Filter"      
),

"Join_4" as (
SELECT Transformer."C_NATIONKEY" as "C_NATIONKEY",Transformer."SUM_C_ACCTBAL" as "SUM_C_ACCTBAL",Transformer."COUNT_C_NATIONKEY" as "COUNT_C_NATIONKEY",Transformer."C_ACCTBAL" as "C_ACCTBAL",Transformer."C_CUSTKEY" as "C_CUSTKEY",Transformer."NUNIQUE_C_CUSTKEY" as "NUNIQUE_C_CUSTKEY",Custom_SQL."O_ORDERKEY" as "O_ORDERKEY",Custom_SQL."O_CUSTKEY" as "O_CUSTKEY",Custom_SQL."O_ORDERSTATUS" as "O_ORDERSTATUS",Custom_SQL."O_TOTALPRICE" as "O_TOTALPRICE",Custom_SQL."O_ORDERDATE" as "O_ORDERDATE",Custom_SQL."O_ORDERPRIORITY" as "O_ORDERPRIORITY",Custom_SQL."O_CLERK" as "O_CLERK",Custom_SQL."O_SHIPPRIORITY" as "O_SHIPPRIORITY",Custom_SQL."O_COMMENT" as "O_COMMENT",Custom_SQL."C_CUSTKEY" as "Custom SQL_C_CUSTKEY",Custom_SQL."C_NAME" as "C_NAME",Custom_SQL."C_ADDRESS" as "C_ADDRESS",Custom_SQL."C_NATIONKEY" as "Custom SQL_C_NATIONKEY",Custom_SQL."C_PHONE" as "C_PHONE",Custom_SQL."C_ACCTBAL" as "Custom SQL_C_ACCTBAL",Custom_SQL."C_MKTSEGMENT" as "C_MKTSEGMENT",Custom_SQL."C_COMMENT" as "C_COMMENT",Custom_SQL."L_ORDERKEY" as "L_ORDERKEY",Custom_SQL."L_PARTKEY" as "L_PARTKEY",Custom_SQL."L_SUPPKEY" as "L_SUPPKEY",Custom_SQL."L_LINENUMBER" as "L_LINENUMBER",Custom_SQL."L_QUANTITY" as "L_QUANTITY",Custom_SQL."L_EXTENDEDPRICE" as "L_EXTENDEDPRICE",Custom_SQL."L_DISCOUNT" as "L_DISCOUNT",Custom_SQL."L_TAX" as "L_TAX",Custom_SQL."L_RETURNFLAG" as "L_RETURNFLAG",Custom_SQL."L_LINESTATUS" as "L_LINESTATUS",Custom_SQL."L_SHIPDATE" as "L_SHIPDATE",Custom_SQL."L_COMMITDATE" as "L_COMMITDATE",Custom_SQL."L_RECEIPTDATE" as "L_RECEIPTDATE",Custom_SQL."L_SHIPINSTRUCT" as "L_SHIPINSTRUCT",Custom_SQL."L_SHIPMODE" as "L_SHIPMODE",Custom_SQL."L_COMMENT" as "L_COMMENT" FROM "Transformer"  as Transformer INNER JOIN "Custom_SQL"  as Custom_SQL ON Transformer."C_CUSTKEY"=Custom_SQL."O_CUSTKEY"     
)


SELECT * FROM "Join_4"
        );
